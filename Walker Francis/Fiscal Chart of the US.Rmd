---
title: "Figure 4"
author: "lauryn davis"
date: "6/27/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
# I like this for coloring text: https://wilkelab.org/ggtext/
library(grid)
library(rlang)
library(ggtext)


```

```{r, fig.height= 2.5, fig.width= 8}
type_levels= c("From Public Lands", "Bank Stock", "Internal Revenue", "Customs", "Direct Tax", "Postage", "Miscellaneous")
year_levels <- c("1870", "1869", "1868", "1867", "1866", "1865", "1864", "1863", "1862", "1861", "1860", "1859", "1858", "1857", "1856", "1855", "1854", "1853", "1852", "1851", "1850", "1849", "1848", "1847", "1846", "1845", "1843", "1842", "1841", "1840", "1839", "1838", "1837", "1836", "1835", "1834", "1833", "1832", "1831", "1830", "1829", "1828", "1827", "1826", "1825", "1824", "1823", "1822", "1821", "1820", "1819", "1818", "1817", "1816", "1815", "1814", "1813", "1812", "1811", "1810", "1809", "1808", "1807", "1806", "1805", "1804", "1803", "1802", "1801", "1800", "1799", "1798", "1797", "1796", "1795", "1794", "1793", "1792", "1789") # Need to update the 1789 and 1843 dates with the correct label.
pop_colors <- c("#c0c3b7", "#b2a961","#fedcc6", "#ffe383", "#a48048", '#e19d91', '#737165' )
#pop_colors<- c('#737165', '#e19d91', "#a48048", "#ffe383","#fedcc6","#b2a961", "#c0c3b7"  )

firstbar <- tibble(
  vote_type = rep(type_levels, 79),
  # Need to rep the pop_group within each vote_type
  pop_group = rep(year_levels,c(7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7)),
  amount =   c(0.76,	-0.13,	52.74,	99.84,	-0.2,	-0.2,	7.7,	1.14,	-0.19,	51.27,	99.85,	-0.19,	-0.19,	8.52,	0.48,	-0.11,	59.62,	99.93,	-0.11,	-0.11,	11.93,	0.19,	-0.03,	64.13,	99.87,	9.86,	0.12,	8.76,	0.05,	0.05,	68.2,	99.87,	0.05,	0.05,	12.46,	0.36,	-0.09,	74.85,	99.81,	-0.09,	-0.09,	11.8,	0.14,	0.14,	61.42,	99.89,	0.07,	0.07,	19.71,	0.15,	0.15,	38.84,	99.9,	5.54,	0.08,	4.36,	0.38,	0.01,	-0.06,	99.76,	5.7,	-0.14,	2.37,	2.45,	-0.06,	-0.06,	99.99,	-0.13,	-0.13,	4.82,	3.5,	-0.12,	-0.12,	99.85,	-0.12,	-0.12,	5.34,	3.58,	-0.04,	-0.04,	100,	-0.11,	-0.11,	7.34,	7.5,	0.04,	-0.03,	99.86,	-0.03,	-0.03,	10.75,	5.59,	-0.02,	-0.02,	100.02,	-0.1,	-0.1,	7.58,	12.09,	-0.02,	-0.02,	99.95,	-0.02,	-0.02,	13.64,	17.56,	0.06,	0.06,	100.03,	0.07,	0.07,	19.04,	11.52,	-0.08,	-0.08,	99.97,	-0.08,	-0.08,	13.14,	2.81,	0.15,	0.15,	99.9,	0.08,	0.08,	5.03,	4.3,	0.01,	0.01,	100.06,	0.09,	0.09,	5.63,	5.11,	0.02,	0.02,	99.92,	0.09,	0.09,	6.96,	4.98,	0.18,	0.18,	100.07,	0.18,	0.18,	6.31,	5.87,	0.18,	0.18,	100.08,	0.11,	0.11,	7.13,	9.64,	0.12,	0.12,	99.94,	0.05,	0.05,	11.64,	9.58,	0.05,	0.05,	100.1,	-0.02,	-0.02,	10.83,	9.29,	0.13,	0.13,	100.18,	0.06,	0.06,	10.32,	6.79,	0.14,	0.14,	100.11,	0.14,	0.14,	8.19,	8.2,	0.15,	0.15,	100.05,	0.08,	0.08,	12.04,	6.51,	0.16,	0.16,	100.2,	0.09,	0.09,	9.1,	8.29,	14.35,	0.24,	100.29,	0.17,	0.17,	10.14,	17.38,	30.97,	0.1,	100.22,	0.1,	0.1,	21.88,	22.78,	0.04,	0.04,	100.15,	0.04,	0.04,	27.13,	12.01,	39.1,	0.19,	100.16,	0.19,	0.19,	21.38,	27.37,	55.94,	0.13,	100.32,	0.2,	0.2,	50.26,	49.38,	0.21,	0.21,	100.25,	0.21,	0.21,	54.7,	42.08,	45.92,	0.22,	100.11,	0.07,	0.07,	44.3,	22.67,	25.84,	0.15,	100.19,	0.15,	0.15,	23.19,	11.75,	14.63,	0.08,	100.2,	0.01,	0.01,	12.78,	8.14,	10.73,	0.09,	100.21,	0.09,	0.09,	8.73,	11.32,	15.31,	0.03,	100.22,	0.1,	0.1,	13.46,	9.26,	12,	-0.04,	100.23,	0.03,	0.03,	9.71,	6.02,	8.83,	0.12,	100.01,	0.04,	0.04,	6.76,	4.19,	6.55,	-0.02,	100.09,	-0.02,	-0.02,	4.78,	6.63,	14.31,	-0.01,	100.1,	-0.01,	-0.01,	12.32,	5.9,	7.75,	0.07,	99.96,	-0.01,	-0.01,	6.12,	5.91,	7.83,	0.08,	100.04,	0.08,	0.08,	6.28,	5.4,	7.69,	0.01,	99.98,	0.08,	0.08,	6.06,	4.52,	7.25,	-0.06,	99.84,	-0.06,	-0.06,	5.48,	9.1,	12.87,	0.1,	99.77,	0.1,	0.1,	11.03,	8.3,	10.44,	11.11,	99.93,	0.03,	0.03,	9.56,	9.42,	15.32,	16.36,	99.79,	-0.03,	-0.03,	0.04,	13.49,	16.96,	18.28,	99.72,	0.05,	0.05,	0.05,	12.16,	14.97,	20.88,	99.58,	16.15,	-0.02,	-0.02,	5.97,	7.23,	20.96,	99.74,	12.62,	-0.08,	-0.08,	3.76,	-0.08,	23.92,	99.52,	13.29,	-0.08,	-0.08,	8.13,	-0.14,	53.76,	99.46,	24.07,	9.97,	9.09,	10.05,	-0.06,	46.68,	99.61,	31.76,	0.01,	11.09,	6,	-0.13,	-0.13,	99.7,	-0.13,	-0.13,	7.77,	7.19,	-0.12,	-0.04,	99.55,	-0.04,	8.52,	-0.04,	7.2,	-0.04,	-0.04,	99.49,	0.04,	0.04,	7.57,	7.35,	-0.03,	-0.03,	99.42,	-0.03,	-0.03,	8.53,	6.03,	-0.02,	-0.02,	99.5,	0.05,	0.05,	6.25,	3.75,	-0.09,	-0.09,	99.44,	-0.02,	-0.02,	4.12,	3.02,	-0.08,	-0.08,	99.59,	3.83,	-0.15,	3.32,	5.02,	0,	0,	99.38,	5.98,	0,	0,	4,	0.01,	0.01,	99.46,	4.81,	0.01,	0.01,	4.23,	-0.06,	-0.06,	99.54,	6.07,	-0.06,	4.82,	1.5,	-0.05,	5.49,	99.48,	3.28,	-0.05,	2.39,	1.22,	11.03,	17.09,	99.41,	12.66,	-0.11,	2.4,	1.29,	-0.03,	16.87,	99.35,	8.75,	-0.03,	3.66,	-0.03,	1.23,	16.37,	99.35,	8.69,	2.34,	0.57,	-0.09,	1.31,	12.39,	99.21,	-0.09,	1.98,	0.57,	-0.08,	1.1,	9.74,	99.29,	-0.16,	1.84,	0.21,	0.96,	5.61,	12.99,	99.38,	-0.22,	6.27,	-0.15,	-0.14,	14.99,	21.42,	99.38,	-0.14,	15.73,	-0.14,	-0.21,	2.6,	8.28,	99.39,	-0.21,	3.04,	-0.21,	0.02,	6,	11.24,	99.33,	0.02,	6.52,	0.02,	-0.12,	1.14,	8.3,	99.33,	-0.12,	-0.12,	-0.12,	-0.11,	-0.11,	5.95,	99.34,	-0.11,	-0.11,	-0.11,	-0.02,	-0.02,	-0.02,	99.28,	0.12,	0.05,	0.05),
  fill = rep(pop_colors, 79))

firstbar <- firstbar %>% 
  mutate(vote_type = factor(vote_type, levels = type_levels),
         pop_levels = factor(pop_group, levels = pop_group,
         fill = factor(fill, levels = pop_colors)))

area<- ((ggplot(firstbar, aes(x = pop_levels, 
                      y = amount, fill=fill, label=''))+
  geom_col(color = "black", size= .2, width=.7)) + scale_fill_manual(labels= type_levels, values= pop_colors, name = "")+
  theme_classic()+
    theme( panel.grid = element_blank(),
           plot.background = element_rect(fill = "white", color = "black"),
           panel.grid.major = element_blank(),
           panel.grid.minor = element_blank(),
           plot.title = element_markdown(hjust=.02),
           plot.title.position = "plot",
           plot.caption.position = "plot",
           plot.subtitle = element_markdown(hjust= .009), 
           plot.caption = element_text(size = 8, color = "black", hjust = 0),
           axis.ticks = element_blank(),
           axis.line.y = element_blank(),
           legend.position= "top",
           axis.line.x = element_blank(),
           axis.text.x= element_blank(),
           axis.text.y= element_text(margin = margin(r = -5), color= "black", size=12),
           plot.margin = unit(c(.5,.5,.5,.5), "cm")) + scale_y_continuous(limits= c(0,165)))
     
save<- area + coord_flip()        
ggsave('save.png')

firstbar

```
 
