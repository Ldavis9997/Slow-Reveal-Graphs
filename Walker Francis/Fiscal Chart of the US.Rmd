---
title: "Figure 4"
author: "lauryn davis"
date: "6/27/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
# I like this for coloring text: https://wilkelab.org/ggtext/
library(grid)
library(rlang)
library(ggtext)
library(showtext)

```

```{r, fig.height= 2.5, fig.width= 8}
type_levels= c("From Public Lands", "Bank Stock", "Internal Revenue", "Customs", "Direct Tax", "Postage", "Miscellaneous")
year_levels <- c("1870", "1869", "1868", "1867", "1866", "1865", "1864", "1863", "1862", "1861", "1860", "1859", "1858", "1857", "1856", "1855", "1854", "1853", "1852", "1851", "1850", "1849", "1848", "1847", "1846", "1845", "1843", "1842", "1841", "1840", "1839", "1838", "1837", "1836", "1835", "1834", "1833", "1832", "1831", "1830", "1829", "1828", "1827", "1826", "1825", "1824", "1823", "1822", "1821", "1820", "1819", "1818", "1817", "1816", "1815", "1814", "1813", "1812", "1811", "1810", "1809", "1808", "1807", "1806", "1805", "1804", "1803", "1802", "1801", "1800", "1799", "1798", "1797", "1796", "1795", "1794", "1793", "1792", "1789") # Need to update the 1789 and 1843 dates with the correct label.
pop_colors <- c("#c0c3b7", "#b2a961","#fedcc6", "#ffe383", "#a48048", '#e19d91', '#737165' )
#pop_colors<- c('#737165', '#e19d91', "#a48048", "#ffe383","#fedcc6","#b2a961", "#c0c3b7"  )

firstbar <- tibble(
  vote_type = rep(type_levels, 79),
  # Need to rep the pop_group within each vote_type
  pop_group = rep(year_levels,c(7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7)),
  amount =   c(1.17, 0.0, 45.23, 47.06, 0.0, 0.0, 6.6, 1.68, 0.0, 42.83, 48.46, 0.0, 0.0, 7.1, 0.67, 0.0, 47.64, 40.2, 0.0, 0.24, 11.5, 0.16, 0.0, 54.4, 35.87, 0.0, 1.03, 8.8, 0.16, 0.0, 55.81, 31.8, 0.0, 0.02, 12.5, 0.16, 0.0, 62.94, 24.94, 0.0, 0.01, 11.9, 0.41, 0.0, 41.53, 38.42, 0.0, 0.1, 19.7, 0.0, 0.0, 33.46, 61.05, 0.0, 1.28, 4.4, 0.67, 0.0, 0.0, 93.99, 0.0, 3.58, 1.7, 2.83, 0.0, 0.0, 94.88, 0.0, 0.0, 2.0, 3.72, 0.0, 0.0, 94.5, 0.0, 0.0, 2.0, 3.85, 0.0, 0.0, 92.34, 0.0, 0.0, 3.8, 7.92, 0.0, 0.0, 89.16, 0.0, 0.0, 3.0, 5.75, 0.0, 0.0, 92.34, 0.0, 0.0, 1.8, 12.24, 0.0, 0.0, 86.11, 0.0, 0.0, 1.7, 17.84, 0.0, 0.0, 80.64, 0.0, 0.0, 1.3, 11.73, 0.0, 0.0, 86.74, 0.0, 0.0, 1.4, 3.21, 0.0, 0.0, 94.76, 0.0, 0.0, 1.9, 4.48, 0.0, 0.0, 94.12, 0.0, 0.0, 1.3, 5.12, 0.02, 0.0, 92.72, 0.0, 0.0, 2.1, 4.99, 0.0, 0.0, 93.61, 0.0, 0.0, 1.4, 5.75, 0.0, 0.0, 92.72, 0.0, 0.0, 1.3, 9.82, 0.0, 0.0, 88.27, 0.0, 0.0, 1.8, 9.7, 0.0, 0.0, 88.91, 0.0, 0.0, 1.3, 9.31, 0.0, 0.0, 89.29, 0.0, 0.0, 1.3, 6.9, 0.0, 0.0, 91.58, 0.0, 0.0, 1.3, 8.3, 0.0, 0.0, 88.02, 0.0, 0.0, 3.8, 6.64, 0.0, 0.0, 90.69, 0.0, 0.0, 2.5, 8.17, 4.03, 0.0, 85.34, 0.0, 0.0, 2.1, 17.2, 9.2, 0.0, 68.81, 0.0, 0.0, 4.7, 22.92, 0.0, 0.0, 72.75, 0.0, 0.0, 4.1, 12.11, 17.89, 0.0, 60.93, 0.0, 0.0, 9.3, 27.37, 5.63, 0.0, 44.14, 0.0, 0.0, 23.2, 49.37, 0.53, 0.0, 45.03, 0.0, 0.0, 5.2, 42.0, 1.7, 0.0, 54.31, 0.0, 0.0, 2.3, 22.54, 2.96, 0.0, 74.03, 0.0, 0.0, 0.7, 11.73, 2.27, 0.0, 85.34, 0.0, 0.0, 0.9, 8.04, 2.16, 0.0, 89.41, 0.0, 0.0, 0.8, 11.22, 1.98, 0.0, 84.33, 0.0, 0.0, 2.4, 9.19, 2.31, 0.0, 87.89, 0.0, 0.0, 0.7, 6.13, 2.17, 0.0, 91.45, 0.0, 0.0, 0.7, 4.1, 1.8, 0.0, 93.74, 0.0, 0.0, 0.8, 6.64, 2.06, 0.0, 85.47, 0.0, 0.0, 5.8, 5.88, 1.32, 0.0, 92.34, 0.0, 0.0, 0.6, 5.75, 1.75, 0.0, 91.96, 0.0, 0.0, 0.6, 5.37, 1.83, 0.0, 92.34, 0.0, 0.0, 0.7, 4.48, 1.82, 0.0, 92.72, 0.0, 0.0, 1.1, 9.06, 2.04, 0.31, 86.87, 0.0, 0.0, 2.0, 8.17, 0.63, 0.74, 88.78, 0.0, 0.0, 1.7, 9.19, 5.31, 1.19, 83.31, 0.0, 0.0, 0.8, 13.26, 2.84, 1.16, 81.4, 0.0, 0.1, 0.8, 11.98, 2.52, 5.7, 79.37, 0.0, 0.2, 0.7, 5.88, 0.92, 8.8, 78.99, 0.0, 5.0, 0.5, 3.59, 0.0, 7.05, 75.81, 0.67, 13.0, 0.0, 7.92, 0.0, 23.8, 46.56, 0.92, 20.0, 1.3, 9.82, 0.0, 9.99, 53.68, 0.81, 25.0, 1.3, 5.75, 0.0, 0.0, 92.34, 0.09, 30.0, 2.2, 7.03, 0.0, 0.0, 91.19, 1.29, 0.0, 0.7, 7.03, 0.0, 0.0, 92.59, 0.0, 0.0, 0.7, 7.03, 0.0, 0.0, 91.83, 0.0, 0.0, 1.9, 5.63, 0.0, 0.0, 94.25, 0.0, 0.1, 0.9, 3.59, 0.0, 0.0, 95.9, 0.0, 0.0, 1.0, 2.7, 0.0, 0.0, 95.9, 0.0, 0.0, 1.2, 4.86, 0.0, -0.07, 93.99, 0.0, 0.1, 1.1, 3.59, 0.0, -0.11, 95.26, 0.0, 0.1, 1.4, 3.85, 0.0, 0.15, 93.87, 0.0, 0.1, 2.3, 1.3, 0.0, 1.53, 94.88, 0.0, 0.5, 2.3, 1.05, 8.5, 3.22, 83.18, 0.0, 3.0, 1.5, 0.92, 0.67, 1.75, 83.31, 0.75, 10.0, 2.8, 0.0, 0.6, 7.92, 83.95, 1.2, 6.0, 0.8, 0.0, 1.0, 0.35, 88.02, 0.75, 10.0, 0.6, 0.0, 1.0, 8.05, 90.69, 0.77, 0.0, 0.2, 0.54, 4.26, 7.02, 87.25, 0.62, 0.0, 0.9, 0.0, 15.1, 5.62, 78.73, 1.06, 0.0, 0.0, 0.0, 2.9, 5.36, 91.7, 0.25, 0.0, 0.0, 0.0, 6.1, 5.11, 88.65, 0.5, 0.0, 0.0, 0.0, 1.0, 7.02, 92.08, 0.5, 0.0, 0.0, 0.0, 0.0, 5.49, 94.25, 0.74, 0.0, 0.0, 0.0, 0.0, 0.0, 100.35, 0.0, 0.0, 0.0),
  fill = rep(pop_colors, 79))

vote_labels <- tibble(
  vote_type = factor(type_levels, levels = type_levels))
firstbar <- firstbar %>% 
  mutate(vote_type = factor(vote_type, levels = type_levels),
         pop_group = factor(pop_group, levels = year_levels),
         fill = factor(fill, levels = pop_colors))

area<- ((ggplot(firstbar, aes(x = pop_group, 
                      y = amount, fill=fill, label=''))+
  geom_col(color = "black", size= .2, width=.7)) + scale_fill_manual(labels= type_levels, values= pop_colors, name = "")+
  theme_classic()+
    theme( panel.grid = element_blank(),
           plot.background = element_rect(fill = "white", color = "black"),
           panel.grid.major = element_blank(),
           panel.grid.minor = element_blank(),
           plot.title = element_markdown(hjust=.02),
           plot.title.position = "plot",
           plot.caption.position = "plot",
           plot.subtitle = element_markdown(hjust= .009), 
           plot.caption = element_text(size = 8, color = "black", hjust = 0),
           axis.ticks = element_blank(),
           axis.line.y = element_blank(),
           legend.position= "top",
           axis.line.x = element_blank(),
          
           axis.text.y= element_text(margin = margin(r = -5), color= "black", size=12),
           plot.margin = unit(c(.5,.5,.5,.5), "cm")) + scale_y_continuous(limits= c(0,165)))
     
save<- area + coord_flip()        
ggsave('save.png')

firstbar

```
 
