#Code for the iraq exports:

```{r,fig.height= 10, fig.width= 16}
year_groups= c("2001", "2002", "2003")
types= c("Weekly average")
pop_colors <- c("#31542c")


iraq_data<- tibble(
  vote_type = rep(types, 3),
  pop_groups= rep(year_groups, c(26, 40, 38)),
  amount= c(0.4299662264036030,
1.0445840009910300,
0.81988282470091,
0.26044456521141000,
0.6752105870308600,
0.8202183758062350,
1.799530490607360,
1.9195521498547200,
0.22102352424505100,
1.5600588517735600,
1.7749979764624700,
1.7900977762021000,
1.4854546560229200,
2.609656495321610,
2.329980862942370,
1.8404987950038300,
2.335194332893630,
2.540160133063140,
2.170556804456720,
2.125717234530300,
2.0958407583376300,
2.1059321471348200,
1.9711710948905800,
2.271023290954850,
2.5509164101616200,
1.4668999226803000,
0.987938003284643,
2.307001826136950,
1.7425737974330700,
2.4920644746331800,
2.0325458776183200,
2.032657727986760,
2.4424464084105500,
1.8729975409455100,
2.077944699386950,
1.9831515121325700,
2.3929153369189300,
1.3088926355282500,
2.6229542613474700,
2.143451731837670,
2.3134270084129900,
2.1686491342838600,
2.1237971365387100,
1.5893325787585100,
2.718530401180940,
1.6245343752708800,
2.733748265198380,
0.8803441627530350,
0.9204238781113290,
1.4151380577292000,
1.9098584512564300,
2.2546807093436400,
0.42626273642630900,
1.5704485082199300,
2.0401827722191500,
1.9753530558884300,
1.6707037217998900,
1.5359302417369400,
1.506053765544270,
2.5453301056488900,
2.0758133284772000,
1.6662545626996500,
0.9869127082405930,
2.4158819459056300,
1.127023936441960,
1.257031348027430,
1.015279204459290,
1.3126396228710500,
1.0179884689393300,
1.247909329090070,
0.44366789653771700,
1.1182498964286400,
1.1633193810013100,
0.9236240414306350,
0.7538786795015600,
1.4284358237550500,
1.168768979508170,
1.2288139856333100,
0.6443958105251580,
1.0591804740726800,
0.7795110556027940,
0.7096791422389940,
0.37506012331741800,
0.9247301172963370,
1.9440225249060300,
1.1597463831205300,
1.4296599638985600,
0.6054221710325650,
3.103519369357460,
0.7405312022008440,
2.823974229074730,
1.070489789104010,
1.2154851500606700,
2.489585124799390,
1.730295112541910,
1.8053404958569700,
0.5514481543500610,
2.0453713865329700,
2.0904470850150000,
1.915687098234120,
0.9815563183741050,
2.2206657695186300,
1.6662359209715800,
2.2208832563461500,
), 
  amount1= as.string(amount)
)

iraq_data<- iraq_data%>%
  mutate(vote_type = factor(vote_type, levels= types),
         pop_groups= factor(pop_groups, levels= year_groups),
         fill= factor(fill, levels= pop_colors))
area<- (ggplot(vote_data, aes(x = pop_groups, 
                      y = amount, 
                      fill = fill, 
                      label = amount1))
                      
 area<- (ggplot(iraq_data, aes(x = pop_groups, 
                      y = amount, 
                      fill = fill, 
                      label = amount1)) +   
                      +
 geom_text(size = 3, 
            position = position_dodge(width=.8), aes(y= amount, hjust= .5), vjust =-.5, color= "black")+
  geom_col(color = "black", size= .2,width= .7, position= position_dodge(width= .8))



---
title: "Census Figure 6"
author: "lauryn davis"
date: "6/7/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
# I like this for coloring text: https://wilkelab.org/ggtext/
remotes::install_github("wilkelab/ggtext")
library(ggtext)



# Colors from https://imagecolorpicker.com/
# Main text: #a21e3c
# Noncit: #af5d62
# No resp: #e6cdcb
# Nonvote: #c58887
# Voters: #971c3c
```

```{r,fig.height= 5, fig.width= 8}
age_groups= c("18-29 year olds", "30-44 year olds", "45-64 year olds", "65 years and older")
types= c("White non-Hispanic", "Black non-Hispanic", "Other race non-Hispanic", "Hispanic")

pop_colors <- c("#e6cdcb", "#c58887", "#af5d62", "#971c3c")


vote_data<- tibble(
  vote_type = rep(types, 4),
  pop_groups= rep(age_groups, c(4,4,4,4)),
  amount= c(63.3, 15.0, 6.8, 14.9, 68.9, 13.1, 6.8, 11.2, 74.8, 11.9, 5.2, 8.0, 81.7, 8.8, 4.0,5.5), 
  amount1= c("63.3", "15.0", "6.8", "14.9", "68.9", "13.1", "6.8", "11.2", "74.8", "11.9", "5.2", "8.0", "81.7", "8.8", "4.0","5.5"),
  fill= rep(pop_colors, 4)
)
vote_labels <- tibble(
  vote_type= factor(types, levels= types),
)
vote_data<- vote_data%>%
  mutate(vote_type = factor(vote_type, levels= types),
         pop_groups= factor(pop_groups, levels= age_groups),
         fill= factor(fill, levels= pop_colors))
area<- (ggplot(vote_data, aes(x = pop_groups, 
                      y = amount, 
                      fill = fill, 
                      label = amount1)) +
 geom_text(size = 3, 
            position = position_dodge(width=.8), aes(y= amount, hjust= .5), vjust =-.5, color= "black")+
  geom_col(color = "black", size= .2,width= .7, position= position_dodge(width= .8)) +
  scale_fill_manual(values = pop_colors) 
+
 labs(title = "<span style = 'font-size:11pt; color:#000000'><b>Figure 6.</span></p><p><span style = 'font-size:12pt; color:#a21e3c'><b>Composition of Voters by Age and Race and Hispanic Origin: 2016</span></p>",
       subtitle = "<span style = 'font-size:10pt; color:#000000'>(In Percent)</span>",
       y = "",
       x = "",
       caption = "Source: U.S. Census Bureau, Current Population Survey, November 1980-2016.") + scale_fill_manual(labels= types, values= pop_colors, name = ""))

new<- (area + theme_classic()+
  theme(
           # Needed for using HTML syntax in plot title
           # plot.title = element_markdown(), 
           # Cleaned up some redundancies and combined your theme changes into one layer
           panel.grid = element_blank(),
           plot.background = element_rect(fill = "white", color = "black"),
           panel.grid.major = element_blank(),
           panel.grid.minor = element_blank(),
           plot.title = element_markdown(hjust= .05),
           plot.title.position = "plot",
           plot.caption.position = "plot",
           plot.subtitle = element_markdown(hjust=.01), 
           plot.caption = element_text(size = 8, color = "black", hjust = 0),
           axis.ticks = element_blank(),
           axis.line.y = element_blank(),
           axis.text.y= element_blank(),
           axis.line.x = element_line(size=.1),
           axis.text.x= element_text(color= "black"),
           legend.key.height= unit(.2, 'cm'), legend.key.width= unit(.7, 'cm'),
           legend.spacing.x = unit(.1, 'cm'),
            plot.margin = unit(c(.5,.5,.5,.5), "cm"),
           legend.position="top",
           legend.text=element_text(margin=margin(r=.3,unit="inch")))
+ scale_x_discrete(expand=c(.2,0))
+ guides(fill = guide_legend(byrow = TRUE))
+ scale_y_continuous(expand = expansion(mult = c(0, .15))))






```

