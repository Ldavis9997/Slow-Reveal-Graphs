---
title: "Oil Ministry Production Goals"
author: "Lauryn Davis"
date: "7/25/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(grid)
library(rlang)
library(ggtext)
library(ggrepel)
```

```{r, fig.height= 5, fig.width= 8}
type_levels= c("Unimproved existing fields", "Improved production from existing fields", "Undeveloped discovered fields", "Undiscovered fields")
year_levels= c("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
colors= c('#85b838', '#d9361c', '#e2e02a', '#0c0202')

data<- tibble(
  iraq_type= rep(type_levels, 20),
  iraq_year= rep(year_levels, c(4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4)),
  amount= c(2.8,
3.4,
0.0,
0.0,
2.8,
3.4,
0.0,
0.0,
2.5,
3.5,
3.8,
0.0,
2.2,
3.5,
4.4,
0.0,
1.8,
3.5,
4.9,
0.0,
1.8,
3.5,
5.4,
0.0,
1.7,
3.5,
5.6,
0.0,
1.7,
3.5,
6.0,
0.0,
1.6,
3.5,
6.0,
0.0,
1.5,
3.5,
6.0,
0.0,
1.5,
3.5,
6.0,
0.0,
1.4,
3.5,
6.0,
0.0,
1.3,
3.4,
6.0,
0.0,
1.2,
3.4,
6.0,
0.0,
1.2,
3.3,
5.8,
6.0,
1.1,
3.2,
5.6,
6.0,
1.1,
3.2,
5.6,
6.0,
1.0,
3.1,
5.6,
6.0,
0.9,
3.1,
5.4,
6.0,
0.8,
3.0,
5.3,
6.0
),
fill = rep(colors, 20))
data

labels <- tibble(
  iraq_type = factor(type_levels, levels = type_levels))
labels <- data %>% 
  mutate(iraq_type = factor(iraq_type, levels = type_levels),
         fill = factor(fill, levels = colors))

initial<- (ggplot(data, aes(x= iraq_year, 
                             y= amount,
                             fill=fill,
                            label= amount)) +
              geom_col(color= "black", size= .2, width= .7) +
             geom_text(size = 4, 
            position = position_stack(vjust = 0.5)))
initial + scale_fill_manual(labels= type_levels, values= colors, name = "") 
```