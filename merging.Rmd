```{r}
library(tidyverse)
library(showtext)
library(readxl)
library(ggpubr)
library(magick)
library(showtext)
library(extrafont)
library(grid)
```
```{r}
font_files() %>% tibble() %>% filter(str_detect(family, "Playfair")) %>% pull(file)
names(pdfFonts())

font_add(family = "Rokkitt1", regular = "Rokkitt-SemiBold.ttf")
font_add(family = "Rokkitt", regular = "Rokkitt-Regular.ttf")
font_add(family = "playfair", regular = "PlayfairDisplay-MediumItalic.ttf")

font_add_google(name = "Barlow Condensed", family = "Circle")
showtext_auto()

```

```{r}
background<- image_read(here::here('Walker Francis', "white.png"))
plot1<- image_read(here::here('Walker Francis', "save.png"))
plot2 <- image_read(here::here('Walker Francis', "save1.png"))
plot3 <- image_read(here::here('Walker Francis', "save3.png"))

img<- image_draw(background)


 dev.off()


```

```{r}

picture <- image_graph(width = 1500, height = 900)
annotation_custom2 <- 
function (grob, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax =Inf, data) 
{
  layer(data = data, stat = StatIdentity, position = PositionIdentity, 
        geom = ggplot2:::GeomCustomAnn, 
        inherit.aes = TRUE, params = list(grob = grob, 
                                          xmin = xmin, xmax = xmax, 
                                          ymin = ymin, ymax = ymax))
}

ggplot()+theme_void()
    
dev.off()
img <- image_draw(picture)

grid.raster(plot1, .19, .4, height =.75)
grid.raster(plot2, .84, .4, height = .75)
grid.raster(plot3, .525, .42, height = .75)
text(1245,210, substitute(bold("3. EXPENDITURES.")), cex = 1.1, col = "black", family = 'Rokkitt1')+
  text(775,190, substitute(bold("2- PUBLIC HEALTH.")), cex = 1.1, col = "black", family = 'Rokkitt1')+
  text(995,210, substitute(bold("In millions and tenths")), cex = .7, col = "black", family = 'playfair')+
  text(995,220, substitute(bold("(00,000 omitted)")), cex = .7, col = "black", family = 'playfair')+
  
  text(565,210, substitute(bold("In millions and tenths")), cex = .7, col = "black", family = 'playfair')+
  text(565,220, substitute(bold("(00,000 omitted)")), cex = .7, col = "black", family = 'playfair')+
  
  text(775,35, substitute(bold("FISCAL CHART")), cex = 2, col = "black", family = 'Rokkitt1')+
  text(775,52, substitute(bold("OF THE UNITED STATES")), cex = 1.5, col = "black", family = 'Rokkitt1')+
  text(775,67, substitute(bold("SHOWING THE COURSE OF THE PUBLIC DEBT BY YEARS 1789 TO 1870.")), cex = 1, col = "black", family = 'Rokkitt')+
  text(775,77, substitute(bold("TOGETHER WITH THE PROPORTION OF THE TOTAL")), cex = 1, col = "black", family = 'Rokkitt')+
  text(775,91, substitute(bold("RECIEPTS")), cex = 1.5, col = "black", family = 'Rokkitt1')+
   text(775,104, substitute(bold("FROM EACH PRINCIPLE SOURCE OF REVENUE")), cex = 1, col = "black", family = 'Rokkitt')+
  text(775,114, substitute(bold("AND PROPORTION OF THE TOTAL")), cex = 1, col = "black", family = 'Rokkitt')+
  text(775,128, substitute(bold("EXPENDITURES")), cex = 1.5, col = "black", family = 'Rokkitt1')


dev.off()
image_write(img, path = here::here('Walker Francis', "final.png"), format = "png")

```