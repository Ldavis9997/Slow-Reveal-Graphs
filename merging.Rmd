```{r}
library(tidyverse)
library(showtext)
library(readxl)
library(ggpubr)
library(magick)
library(showtext)
library(extrafont)
library(grid)
```
```{r}
font_files() %>% tibble() %>% filter(str_detect(family, "Playfair")) %>% pull(file)
names(pdfFonts())

font_add(family = "Rokkitt1", regular = "Rokkitt-SemiBold.ttf")
font_add(family = "Rokkitt", regular = "Rokkitt-Regular.ttf")
font_add(family = "playfair", regular = "PlayfairDisplay-MediumItalic.ttf")

font_add_google(name = "Barlow Condensed", family = "Circle")
showtext_auto()

```

```{r}
background<- image_read(here::here('Walker Francis', "white.png"))
plot1<- image_read(here::here('Walker Francis', "save.png"))
plot2 <- image_read(here::here('Walker Francis', "save1.png"))
plot3 <- image_read(here::here('Walker Francis', "save3.png"))

img<- image_draw(background)


 dev.off()


```

```{r}
type_levels <- c('one')
year_levels <- c(1860,1859,1858,1857,1856,1855,1854,1853,1852,1851,1850,1849,1848,1847,1846,1845,1844,1842,1841,1840,1839,1838,1837,1836,1835,1834,1833,1832,1831,1830,1829,1828,1827,1826,1825,1824,1823,1822,1821,1820,1819,1818,1817,1816,1815,1814,1813,1812,1811,1810,1809,1808,1807,1806,1805,1804,1803,1802,1801,1800,1799,1798,1797,1796,1795,1794,1793,1792)
year_levels1<- rev(year_levels)
pop_colors<- c("#d69083")
firstbar <- tibble(
  vote_type = rep(type_levels, 68),
  # Need to rep the pop_group within each vote_type
  pop_group = rep(year_levels,c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)),
  amount = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
  fill = rep(pop_colors, 68))
picture <- image_graph(width = 1500, height = 900)
annotation_custom2 <- 
function (grob, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax =Inf, data) 
{
  layer(data = data, stat = StatIdentity, position = PositionIdentity, 
        geom = ggplot2:::GeomCustomAnn, 
        inherit.aes = TRUE, params = list(grob = grob, 
                                          xmin = xmin, xmax = xmax, 
                                          ymin = ymin, ymax = ymax))
}

ggplot(firstbar, aes(x = pop_group, 
                      y = amount, fill=fill, label=''))+
  geom_col(color = "black", size= .3, width=1)+ 
  coord_flip()+
theme_classic()+
    theme( panel.grid = element_blank(),
           panel.grid.major = element_blank(),
           panel.grid.minor = element_blank(),
           axis.ticks = element_blank(),
           axis.line.y = element_blank(),
           axis.text.y= element_text(color='black', family='Rokkitt', size=12, margin = unit(0,'cm')),
           axis.text.x=element_blank(),
           axis.title=element_blank(),
           axis.line.x = element_blank(),
           legend.position='none',
           plot.margin = unit(c(.5,1,.5,1.2), "cm")) + scale_y_continuous(limits= c(0,101), expand=c(0,0)) + scale_x_discrete(position='top',expand=c(0,3))
dev.off()
img <- image_draw(picture)

grid.raster(plot1, .19, .4, height =.75)
grid.raster(plot2, .84, .4, height = .75)
grid.raster(plot3, .525, .42, height = .75)



dev.off()
image_write(img, path = here::here('Walker Francis', "final.png"), format = "png")

```